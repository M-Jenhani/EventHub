<mat-toolbar color="primary" class="app-toolbar">
  <button mat-button routerLink="/" class="home-button">
    <mat-icon>event</mat-icon>
    <span class="logo">EventHub</span>
  </button>
  
  <span class="spacer"></span>
  
  <!-- Dark mode toggle - always visible -->
  <button mat-icon-button (click)="themeService.toggleTheme()" class="theme-toggle">
    <mat-icon>{{ themeService.isDarkMode() ? 'light_mode' : 'dark_mode' }}</mat-icon>
  </button>
  
  <button mat-button routerLink="/events">
    <mat-icon>list</mat-icon>
    Events
  </button>
  
  <ng-container *ngIf="authService.isLoggedIn()">
    <button mat-button (click)="navigateToDashboard()">
      <mat-icon>dashboard</mat-icon>
      Dashboard
    </button>
    
    <button mat-icon-button [matMenuTriggerFor]="notificationMenu" class="notification-button">
      <mat-icon>notifications</mat-icon>
      <span *ngIf="unreadCount > 0" class="notification-badge">{{unreadCount}}</span>
    </button>
    
    <mat-menu #notificationMenu="matMenu" class="notification-menu">
      <div class="notification-header" style="display: flex; justify-content: space-between; align-items: center; padding: 12px 16px;">
        <strong>Notifications</strong>
        <button mat-button class="mark-all-read-btn" *ngIf="unreadCount > 0" (click)="markAllRead($event)" type="button">
          Mark all read
        </button>
      </div>
      <mat-divider></mat-divider>
      <ng-container *ngIf="notifications.length > 0; else noNotifications">
        <button mat-menu-item *ngFor="let notification of notifications" 
                [ngStyle]="{
                  'padding': '12px 16px',
                  'border-left': notification.read ? '4px solid transparent' : '4px solid var(--primary-color)',
                  'background': hoverNotification === notification ? (notification.read ? 'rgba(99, 102, 241, 0.1)' : 'rgba(99, 102, 241, 0.3)') : (notification.read ? 'transparent' : 'rgba(99, 102, 241, 0.2)'),
                  'font-weight': notification.read ? 'normal' : '600',
                  'color': 'var(--text-color)'
                }"
                (mouseover)="hoverNotification = notification"
                (mouseout)="hoverNotification = null"
                (click)="onNotificationClick(notification)">
          <mat-icon [color]="notification.read ? '' : 'primary'">
            {{ getNotificationIcon(notification.type) }}
          </mat-icon>
          <div class="notification-content">
            <span class="notification-message">{{ notification.message }}</span>
            <small class="notification-time">{{ notification.createdAt | date:'short' }}</small>
          </div>
        </button>
      </ng-container>
      <ng-template #noNotifications>
        <div mat-menu-item disabled class="no-notifications">
          <mat-icon>notifications_none</mat-icon>
          <span>No notifications</span>
        </div>
      </ng-template>
    </mat-menu>
    
    <button mat-icon-button [matMenuTriggerFor]="userMenu">
      <mat-icon>account_circle</mat-icon>
    </button>
    
    <mat-menu #userMenu="matMenu">
      <div class="user-info" mat-menu-item disabled>
        <strong>{{ (authService.currentUser$ | async)?.firstName }}</strong>
        <small>{{ (authService.currentUser$ | async)?.email }}</small>
      </div>
      <mat-divider></mat-divider>
      <button mat-menu-item (click)="logout()">
        <mat-icon>logout</mat-icon>
        Logout
      </button>
    </mat-menu>
  </ng-container>
  
  <ng-container *ngIf="!authService.isLoggedIn()">
    <button mat-button routerLink="/login">
      <mat-icon>login</mat-icon>
      Login
    </button>
    <button mat-raised-button color="accent" routerLink="/register" class="register-btn">
      Register
    </button>
  </ng-container>
</mat-toolbar>


<app-backend-wakeup-message [show]="!backendActive"></app-backend-wakeup-message>

<main class="main-content">
  <router-outlet></router-outlet>
</main>

<footer class="app-footer">
  <div class="container">
    <p>&copy; 2025 EventHub. All rights reserved.</p>
  </div>
</footer>
